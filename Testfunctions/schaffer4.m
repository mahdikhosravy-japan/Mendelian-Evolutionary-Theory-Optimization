function [f] = schaffer4(X)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% SCHAFFER FUNCTION N. 4
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% INPUT:
%
% xx = [x1, x2]
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
temp1 = abs(X(:,1:end-1).^2 - X(:,2:end).^2);
temp2 = X(:,1:end-1).^2 + X(:,2:end).^2;

fact1 = ((cos(sin(temp1))).^2 - 0.5);
fact2 =  (1 + 0.01.*temp2).^2;

f = 0.5 + sum( fact1 ./ fact2,2);

% [s1,s2] = size(x);
% f = nan(s1,1);
% Id =1;
% for i =1:s1
% y = 0.5;
% while Id < s2
%     
% fact1 = cos(sin(abs(x(i,Id).^2-x(i,Id+1).^2))) - 0.5;
% fact2 = (1 + 0.001*(x(i,Id).^2+x(i,Id+1).^2)).^2;
% 
% y = y - fact1./fact2;
% Id =Id+1;
% end
% f(i,:) = y;
% end
% 
% end

